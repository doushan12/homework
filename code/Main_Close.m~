%%  main function :Closed - loop system forward channel identification

%initiate

close all;
z = zk_1(10:end, 2);%select middle part of the data 
u = uk_1(10:end, 2);

%configeration
L = 1800; 
na = 2;
nb = 1;
d = 1;

%RLS
[Theta_F, Inn, J, lambda] = RLS(na, nb + d, z, u, L);
Theta_ex_F = Theta_F(:, end);
disp(Theta_ex_F);
disp(lambda); 

%% plot 

figure;
hold on;
plotForward(Theta_F, [1.4, 0.45, 1, 0.7], L);

title('result');
ylim([-1.5, 3]);
hold off;
